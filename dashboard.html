<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>My Jobs - PM4Subs</title>
        <link
            rel="icon"
            href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>"
        />
        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Manrope:wght@400;500;600&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="assets/css/tailwind-input.css" />
        <link rel="stylesheet" href="dashboard-style.css" />
    </head>
    <body>
        <!-- Main Container -->
        <div class="app-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h1 class="app-title">PM4Subs</h1>
                </div>

                <button class="btn-new-job" id="newJobBtn">
                    <span class="plus-icon">+</span>
                    New Job
                </button>

                <nav class="sidebar-nav">
                    <div class="nav-section">
                        <a href="#" class="nav-link active">Active Jobs</a>
                    </div>
                    <div class="nav-section">
                        <a href="#" class="nav-link">Archived</a>
                    </div>
                    <div class="nav-section">
                        <a href="#" class="nav-link">Help</a>
                    </div>
                </nav>

                <div class="sidebar-footer">
                    <button class="btn-logout" id="logoutBtn">Sign Out</button>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Top Navigation -->
                <header class="top-nav">
                    <h2 class="page-title">My Jobs</h2>
                    <div class="user-profile">
                        <span class="user-email" id="userEmail"
                            >Loading...</span
                        >
                        <div class="user-avatar" id="userAvatar">--</div>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="content-area">
                    <!-- Jobs Table -->
                    <div class="jobs-table-container">
                        <table class="jobs-table">
                            <thead>
                                <tr>
                                    <th>Job Name</th>
                                    <th>Created</th>
                                    <th>Status</th>
                                    <th>Analyses</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="jobsTableBody">
                                <tr>
                                    <td
                                        colspan="5"
                                        style="
                                            text-align: center;
                                            padding: 48px;
                                        "
                                    >
                                        <div
                                            class="loading-spinner"
                                            style="margin: 0 auto 16px"
                                        ></div>
                                        <span style="color: var(--text-muted)"
                                            >Loading jobs...</span
                                        >
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>

        <!-- Modal: Analyze Spec -->
        <div class="modal-overlay" id="analyzeModal" style="display: none">
            <div class="modal">
                <div class="modal-header">
                    <h3>Analyze Spec</h3>
                    <button class="modal-close" id="closeModalBtn">
                        &times;
                    </button>
                </div>

                <div class="modal-body">
                    <label class="modal-label">What do you want to find?</label>

                    <div class="analysis-options">
                        <button class="analysis-option" data-type="submittals">
                            <span class="option-icon">üìã</span>
                            <span>Submittals</span>
                        </button>

                        <button class="analysis-option" data-type="testing">
                            <span class="option-icon">üß™</span>
                            <span>Testing</span>
                        </button>

                        <button class="analysis-option" data-type="products">
                            <span class="option-icon">üì¶</span>
                            <span>Products & Materials</span>
                        </button>

                        <button class="analysis-option" data-type="custom">
                            <span class="option-icon">‚úèÔ∏è</span>
                            <span>Custom prompt</span>
                        </button>
                    </div>

                    <!-- Custom Prompt Input (hidden by default) -->
                    <div
                        class="custom-prompt-container"
                        id="customPromptContainer"
                        style="display: none"
                    >
                        <textarea
                            class="custom-prompt-input"
                            id="customPromptInput"
                            placeholder="Enter your custom analysis prompt..."
                            rows="4"
                        ></textarea>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="analyzeBtn">
                        Analyze
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: New Job -->
        <div class="modal-overlay" id="newJobModal" style="display: none">
            <div class="modal modal-sm">
                <div class="modal-header">
                    <h3>Create New Job</h3>
                    <button class="modal-close" id="closeNewJobBtn">
                        &times;
                    </button>
                </div>

                <div class="modal-body">
                    <div class="form-group" style="margin-bottom: 0">
                        <label class="form-label">Job Name</label>
                        <input
                            type="text"
                            class="form-control"
                            id="jobNameInput"
                            placeholder="e.g., Downtown Office Building"
                        />
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelNewJobBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="createJobBtn">
                        Create Job
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Delete Job Confirmation -->
        <div class="modal-overlay" id="deleteJobModal" style="display: none">
            <div class="modal modal-sm">
                <div class="modal-header">
                    <h3>Delete Job</h3>
                    <button class="modal-close" id="closeDeleteJobBtn">
                        &times;
                    </button>
                </div>

                <div class="modal-body">
                    <p style="margin: 0 0 12px 0">
                        Are you sure you want to delete
                        <strong id="deleteJobName"></strong>?
                    </p>
                    <p
                        style="
                            margin: 0;
                            color: var(--text-secondary);
                            font-size: 14px;
                        "
                    >
                        This will permanently delete the job, all uploaded
                        specs, and all analyses. This action cannot be undone.
                    </p>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelDeleteJobBtn">
                        Cancel
                    </button>
                    <button class="btn btn-danger" id="confirmDeleteJobBtn">
                        Delete Job
                    </button>
                </div>
            </div>
        </div>

        <script type="module" src="/dashboard.js"></script>
    </body>
</html>
